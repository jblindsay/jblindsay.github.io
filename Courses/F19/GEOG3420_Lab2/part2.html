<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Part 2: Image Contrast Enhancement - GEOG3420 W19 Lab 2</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body class="light">
        <!-- Provide site root to javascript -->
        <script type="text/javascript">var path_to_root = "";</script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { } 
            if (theme === null || theme === undefined) { theme = 'light'; }
            document.body.className = theme;
            document.querySelector('html').className = theme + ' js';
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <ol class="chapter"><li><a href="intro.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li><a href="part1.html"><strong aria-hidden="true">2.</strong> Part 1: Image Histograms</a></li><li><a href="part2.html" class="active"><strong aria-hidden="true">3.</strong> Part 2: Image Contrast Enhancement</a></li><li><a href="part3.html"><strong aria-hidden="true">4.</strong> Part 3: Conversion to Reflectance</a></li></ol>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light <span class="default">(default)</span></button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title">GEOG3420 W19 Lab 2</h1> 

                        <div class="right-buttons">
                            <a href="print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                        </div>
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <a class="header" href="#part-2-contrast-enhancement" id="part-2-contrast-enhancement"><h1>Part 2: Contrast Enhancement</h1></a>
<p>Contrast enhancements, sometimes called radiometric enchancements, are a class of image operations that modify the frequency distribution of image values in an effort optimize the contrast and overall brightness to highlight particular ranges of digital numbers (DNs). The goal of any image enchancement operation is to improve the visualization and interpretation of the data. Contrast ehancement is also an important step in the process of generating a visually appealing colour composite image. If you recall the <code>Balance Contrast Enhancement</code> option that we encountered when we used the <a href="https://jblindsay.github.io/wbt_book/available_tools/image_processing_tools.html#CreateColourComposite"><strong>CreateColourComposite</strong></a> tool, it was performing a type of contrast adjustment internally to ensure that none of the input bands were proportionally brighter than the others.</p>
<p>There are many reasons why the contrast of satellite imagery may be poorly suited to interpretation, including atmospheric scattering and the presence of haze or cloud cover. The <code>band1</code> image from the previous section is an example of how cloud cover can signficantly degrade image quality. In this section of the lab assignment, we will try to improve image radiometric quality through the use of various contrast enchancement tools.</p>
<p><em>WhiteboxTools</em> offers at least six common contrast enchanment methods for use with single-bands of multispectral imagery including:</p>
<ol>
<li><a href="https://jblindsay.github.io/wbt_book/available_tools/image_processing_tools_image_enhancement.html#GaussianContrastStretch">GaussianContrastStretch</a></li>
<li><a href="https://jblindsay.github.io/wbt_book/available_tools/image_processing_tools_image_enhancement.html#HistogramEqualization">HistogramEqualization</a></li>
<li><a href="https://jblindsay.github.io/wbt_book/available_tools/image_processing_tools_image_enhancement.html#MinMaxContrastStretch">MinMaxContrastStretch</a></li>
<li><a href="https://jblindsay.github.io/wbt_book/available_tools/image_processing_tools_image_enhancement.html#PercentageContrastStretch">PercentageContrastStretch</a></li>
<li><a href="https://jblindsay.github.io/wbt_book/available_tools/image_processing_tools_image_enhancement.html#SigmoidalContrastStretch">SigmoidalContrastStretch</a></li>
<li><a href="https://jblindsay.github.io/wbt_book/available_tools/image_processing_tools_image_enhancement.html#StandardDeviationContrastStretch">StandardDeviationContrastStretch</a></li>
</ol>
<p>Each of these techniques for performing contrast enchancements offer various advantages and disadvantages that make them applicable under differing image conditions.</p>
<p>First, let's explore the use of the <strong>GaussianContrastStretch</strong> tool. Using <em>VS Code</em>, create a Python script in your Lab 2 folder (which must also contain the <code>WBT</code> folder with the latest version of the <em>WhiteboxTools</em> library) called <code>contrast.py</code>. Copy the following code into your script file and run it using the <em>VS Code</em> terminal. Be sure to modify the <code>wbt.work_dir</code> to point to the folder containing your lab data.</p>
<pre><code class="language-python">from WBT.whitebox_tools import WhiteboxTools

def main():
    wbt = WhiteboxTools()  # Initialize WhiteboxTools
    wbt.work_dir = &quot;/path/to/your/lab/data/files/&quot;  # Update this
    # perform the stretch
    wbt.gaussian_contrast_stretch(
        i=&quot;band1.tif&quot;,
        output=&quot;band1_gauss_cs.tif&quot;,
        num_tones=4096  # 12-bit depth output
    )
    # visualize the histogram of the resulting image
    wbt.raster_histogram(
        i=&quot;band1_gauss_cs.tif&quot;,
        output=&quot;band1_gauss_cs.html&quot;
    )

    print(&quot;Operation complete!&quot;)


main()
</code></pre>
<blockquote>
<p>Include screenshots of both the resulting contrast-stretched image (<code>band1_gauss_cs.tif</code>) and the associated histogram with your lab hand-in. (2 marks)</p>
</blockquote>
<blockquote>
<p>2.1. Describe how the histogram of the stretched image compares to the original <code>band1</code> histogram. How has it been modified? (2 marks)</p>
</blockquote>
<p>If you haven't already done so, display the <code>band1_gauss_cs.tif</code> using your visualization software.</p>
<blockquote>
<p>2.2. Compare the contrast of the Gaussian stretched image to the original <code>band1</code>. In particular, what objects/land covers are associated with the darkest and the brightest parts of the image? Are you able to distinguish features, such as individual agricultural fields, better in the contrast enhanced image than the original? How much contrast is there between the water (Lake Ontario and Lake Erie) and the surrounding land? Are the streets within urban centres (e.g. Toronto) visible or are they &quot;washed out&quot;? (5 marks)</p>
</blockquote>
<p>Now try to modify your script to use the <strong>HistogramEqualization</strong> tool instead. Be sure to save the modification as a new file. Also, generate the histogram for this newly created histogram-equalized image as well. Be sure to examine the help for this tool in the <em>WhiteboxTools</em> User Manual, so that you are sure you are calling the <code>histogram_equalization()</code> function correctly. You will also want to modify the script so that the output files are called <code>band1_he_cs.tif</code> and <code>band1_he_cs.html</code> instead.</p>
<blockquote>
<p>Include your script for performing the histogram equalization contrast stretch, as well as screenshots of the resulting image (<code>band1_he_cs.tif</code>) and histogram, with your lab hand-in. (2 marks for the script + 2 marks for the screenshots = 5 marks)</p>
</blockquote>
<blockquote>
<p>2.3. Discuss the effects of the histogram equalization contrast stretch on the quality of the image. (5 marks)</p>
</blockquote>
<p>Finally, modify your script again, this time making it apply the <strong>MinMaxContrastStretch</strong> tool to the <code>band1</code> image. A min-max contrast stretch is one in which:</p>
<blockquote>
<p>DN<sub>out</sub> = ((DN<sub>in</sub> – min_val)/(max_val – min_val)) x num_tones</p>
</blockquote>
<p>Any DN<sub>in</sub> &lt; <code>min_val</code> is assigned <code>min_val</code> in the output and any DN<sub>in</sub> &gt; <code>max_val</code> is assigned <code>max_val</code> in the output. That is, all values in the input image below or above specified thresholds (<code>min_val</code> and <code>max_val</code>) are <em>fully saturated</em> in the output image. Use your knowledge of the original image histogram, and the DN value range (from section 1) to help guide you in setting appropriate values for the <code>min_val</code> and <code>max_val</code> parameters. Although it is somewhat subjective what these parameters should be, <code>min_val</code> should be greater than the overall image minimum and <code>max_val</code> should be set to a lower value than the image maximum. This parameterization will require some experimentation with these values until you are satified that you have set them appropriately. Remember, ideally, you would like to saturate the tonal variation within the cloud cover, in order to create an image that emphasizes as much detail in the non-cloud areas as possible. Use the level of detail in the urban areas (do the streets seem 'washed out'), the agricultural fields (can you see the differences in tones within and between fields), and the land-lake contrast as guides.</p>
<blockquote>
<p>Include your <strong>final</strong> script for performing the min-max contrast stretch, as well as screenshots of the resulting image (<code>band1_minmax_cs.tif</code>) and histogram, with your lab hand-in. (2 marks for the script + 2 marks for the screenshots = 5 marks)</p>
<p>2.4. Which of the three tested contrast enchancement techniques afforded you the greatest control over the contrast properties of the output image. Be sure to provide justification for your answer. (2 marks)</p>
<p>2.5. What were the final values that you settled on for the <code>min_val</code> and <code>max_val</code> parameters? Which of the two parameters did you find you needed to change  How did this final image compare with the other contrast enhanced images (i.e. using the Gaussian stretch and histogram equalization)?</p>
<p>2.6. How did the shape of the histogram of the min-max contrast stretched image compare with the original image histogram? (2 marks)</p>
</blockquote>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="part1.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="part3.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a href="part1.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a href="part3.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
