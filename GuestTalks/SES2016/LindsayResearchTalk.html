<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">
		<title>Issues in DEM-based flow-path modelling</title>
		<link rel="stylesheet" href="./revealjs/css/reveal.css">
		<link rel="stylesheet" href="./revealjs/css/theme/white.css" id="theme">
    <link rel="stylesheet" href="./revealjs/lib/css/zenburn.css">
    <link rel="stylesheet" href="./revealjs/css/lindsay.css">

		<!-- If the query includes 'print-pdf', include the PDF print sheet -->
 		<script>
			if( window.location.search.match( /print-pdf/gi ) ) {
				var link = document.createElement( 'link' );
				link.rel = 'stylesheet';
				link.type = 'text/css';
				link.href = './revealjs/css/print/pdf.css';
				document.getElementsByTagName( 'head' )[0].appendChild( link );
			}
 		</script>

		<script
			src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"
			type="text/javascript">
		</script>
	</head>

	<body>

		<div class="reveal">

			<div class="slides">
				<section  data-background="img/title_image4.png" data-background-size="100%" data-background-repeat="repeat">
	        <!-- <section> data-background="img/title_image.png" data-background-size="850px"> -->
	          <div class=transparentTextBox>
							<div id="cornerstone"><img width="auto" height="108px" data-src="img/UGlogo.jpg" alt="UoG"></div>
						</br></br></br><span><h2>Issues in DEM-based </br>flow-path modelling</h2></span>
	            <span>Prof. John Lindsay</br></span>
	            <span><small>Department of Geography,</br> The University of Guelph</small></span></br>
							<span><small></br>January 15, 2016</small></span>
						<!-- </br></br><div id="leftAlignedText"><div><small>Funding provided by: </small></div><img width="auto" height="80px" data-src="img/NSERC_logo.png" alt="NSERC"></div> -->
						<!-- </br></br><table class="leftAlignedText" width="100%"><tr><td><img width="auto" height="108px" data-src="img/UGlogo.jpg" alt="UoG"></td>
						<td class="rightAlignedText"><small>Funding provided by: </small><img width="auto" height="80px" data-src="img/NSERC_logo.png" alt="NSERC"></td></tr></table> -->
	          </div>
					</section>
				</section>

        <!-- <section data-background="img/texture1.png" data-background-size="500px" data-background-repeat="repeat"> -->
				<section>
					<section class=transparentTextBox>
            <h3>Research context</h3>
            <ul>
              <li>My research is in the field of <highlightedText>geomorphometry</highlightedText>.
                <ul>
									<li>Sub-discipline of geomatics concerned with extracting information from digital topographic data
                    (DEMs) to model or better understand landscape processes.</li>
                </ul></li>
							<li>Produce and evaluate <highlightedText>innovative geomorphometric techniques</highlightedText>
								to solve <highlightedText>real world problems</highlightedText> and to make
								<highlightedText>contribution to the theory</highlightedText> of the discipline in which it is applied.</li>
            </ul>
						</br><img class="withShadow" width="auto" height="300px" data-src="img/RoleOfTopography.png" alt="role of topography">
          </section>

          <section class=transparentTextBox>
            <h3>DEMs are used to model surface drainage</h3>
            <ul>
							<li>Based on two basic assumptions:
                <ol>
                  <li><highlightedText>Topography is the dominant factor</highlightedText> affecting the lateral distribution of water.</li>
									<li>Upslope area can be used as a <highlightedText>surrogate for discharge</highlightedText></li>
                </ol>
              </li>
							</br><li>Surface flow-path information is used to:
                <ul>
                  <li>Delineate watershed divides and sub-basins</li>
									<li>Map landforms and soils</li>
									<li>Analyze stream networks</li>
                  <li>Model variable source areas (VSA), runoff, and flooding</li>
                  <li>Model sediment transport, erosion sources, and contaminant migration</li>
                </ul>
              </li>
            </ul>
          </section>

          <section class=transparentTextBox>
            <h3>The spatial hydrology workflow</h3>
            <img class="withShadow" width="352px" height="auto" data-src="img/spatialHydrology2.png" alt="Spatial hydrology workflow">
          </section>

					<section class=transparentTextBox>
            <h3>The spatial hydrology workflow</h3>
            <img class="withBorderAndShadow" width="900px" height="auto" data-src="img/FlowpathModellingImage.png" alt="Spatial hydrology workflow">
          </section>

					<section class=transparentTextBox>
            <h3>The spatial hydrology workflow</h3>
            <img class="withShadow" width="352px" height="auto" data-src="img/spatialHydrology3.png" alt="Spatial hydrology workflow">
          </section>

					<section class=transparentTextBox>
						<h3>Flow-path enforcement: Sink removal</h3>
            <ul>
              <li>DEMs that haven't had flow enforcement will contain
              	<highlightedText>sinks</highlightedText>, i.e. topographic depressions and flats.
              </li>
              <li>Sinks are caused by errors and natural processes.</li>
              <li><highlightedText>Sinks must be removed</highlightedText> from DEMs used in hydrological applications.</li>
            </ul>
            <br/><img class="withBorderAndShadow" width="auto" height="200px" data-src="img/Breaching/SinkRemovalMethods.png" alt="Sink removal">
						<small><ul>
							<li>Lindsay JB. In Press. Efficient hybrid breaching-filling sink removal methods for
								flow path enforcement in digital elevation models. <em>Hydrological Processes</em>.</li>
							<li>Lindsay J, Dhun K. 2015. Modelling surface drainage patterns in altered
								landscapes using LiDAR. <em>International Journal of Geographical Information Science</em> 29: 1-15.</li>
						</ul></small>
					</section>

					<section class=transparentTextBox>
						<h3>Flow-path enforcement: Stream Burning</h3>
						<ul>
							<li>Sometimes the '<em>digital stream</em>' in the DEM doesn't align with
							existing mapped stream data.</li>
							</ul>
						<img class="withBorderAndShadow" width="auto" height="250px" data-src="img/StreamBurning/WhenStreamsDontLineUp.png" alt="When streams don't line up">
						<ul>
								<li>When this happens, practitioners have two options:
									<ol>
										<li><highlightedText>Re-interpolate the DEM</highlightedText>, incorporating
											the mapped hydrography data into the
											interpolation process (e.g. ANUDEM),</li>
										<li><highlightedText>Burn the mapped streams</highlightedText> into the DEM.</li>
									</ol>
								</li>
						</ul>
					</section>

					<section class=transparentTextBox>
            <h3>Stream burning</h3>
            <ul>
              <li>The practice of etching a mapped vector stream network into a raster DEM.</li>
            </ul>
						<img class="withBorderAndShadow" width="500px" height="auto" data-src="img/StreamBurning/streamBurnExample.png" alt="Stream burning algorithm">
						<img class="withBorderAndShadow" width="300px" height="auto" data-src="img/StreamBurning/entrenchedMeander.jpg" alt="Entrenched meander">
						<!-- <small><ul>
							<li>J.B. Lindsay (In press) The practice of DEM stream burning revisited. <em>Earth Surface Processes &amp; Landforms.</em></li>
						</ul></small> -->
          </section>

					<section class=transparentTextBox>
            <h3>Stream burning</h3>
            <ul>
							<li>A simple operation that can be performed in any GIS:
								<ol><li>Rasterize the vector streams layer</li>
									<li>Thin the raster stream lines</li>
									<li>Decrement elevations along the raster streams</li>
									<li>Fill the DEM.</li></ol>
							</li>
              <li>It is extremely common in practice and has been incorporated into several national
								DEM data products.</li>
            </ul>
					</section>

					<section class=transparentTextBox>
            <h3>Stream burning</h3>
            <ul>
							<li>I have long discouraged widespread application of stream burning due its limitations.
								<ul>
									<li>J.B. Lindsay (In press) The practice of DEM stream burning revisited. <em>Earth Surface Processes &amp; Landforms.</em></li>
								</ul>
							</li>
              <li>There is an implicit assumption that the mapped hydrography data is of a <highlightedText>higher
								quality</highlightedText> than the DEM-based streams.
								<ul><li>The blue lines on topo-maps are often of uneven accuracy particularly in
									headwaters.</li></ul>
							</li>
							<li>We always tell our GIS students to exercise extreme caution when <highlightedText>combining data
							layers of vastly different scale</highlightedText>.</li>
            </ul>
					</section>

					<section class=transparentTextBox>
						<h3>Topological errors due to rasterization</h3>
            <img width="auto" height="350px" data-src="img/StreamBurning/piracy2.png" alt="Stream piracy">
						<ul>
							<li>The result of erroneous adjacency and collisions is the <highlightedText>spurious piracy of
								upslope catchment areas</highlightedText>.</li>
							<li>The occurrence of these errors increases with <highlightedText>stream density
								relative to the grid cell size.</highlightedText></li>
							<!-- <li>Line thinning only makes this situation worse.</li> -->
						</ul>
					</section>

					<section class=transparentTextBox>
						<h3>The <em>TopologicalBreachBurn</em> algorithm</h3>
						<ul>
							<li>A new method that aims to <highlightedText>reduce the occurrence and impact of topological
								errors</highlightedText> during burning by:
								<ol>
								</br><li>Tracking the occurrence of collisions during rasterization and
									<highlightedText>pruning smaller headwater streams</highlightedText> from the vector data
									when the error frequency is higher than a specified tolerance;</li>
								</br><li><highlightedText>Prioritizing larger stream links</highlightedText> during the rasterization where there are
										stream collisions; and,</li>
									</br><li><highlightedText>Confining in-stream flow</highlightedText> between neighboring cells of the same link
										identifier value except at link end nodes.</li>
								</ol>
							</li>
						</ul>
					</section>

          <section class=transparentTextBox>
            <img class="withBorderAndShadow" width="auto" height="660px" data-src="img/StreamBurning/Fig1.png" alt="Stream burning algorithm">
          </section>

					<section class=transparentTextBox>
						<h3>Efficient breaching-based flow-path enforcement</h3>
						<ul>
							<li>An efficient <highlightedText>priority-flood</highlightedText> algorithm was used to visit
								DEM cells in the flood order.</li>
							<li>Modified to give stream cells priority.</li>
						</ul>
						</br></br><img class="withBorderAndShadow" width="400px" height="309px" data-src="img/Breaching/priorityFlood2.gif" alt="Priority flood">
					</section>

					<section class=transparentTextBox>
            <img class="withShadow" width="auto" height="600px" data-src="img/StreamBurning/TopologicalBreachBurnTool.png" alt="Whitebox GAT tool">
          </section>

					<section class=transparentTextBox>
						<h3>Study site and data</h3>
            <img class="withBorderAndShadow" width="776px" height="600px" data-src="img/StreamBurning/SiteMapClr.png" alt="Site map">
          </section>

					<section class=transparentTextBox>
						<h3>Study site and data</h3>
						<ul><li>Five test DEM data sources with resolutions ranging from 1 arcsecond (~27 m) to 30 arcseconds (~800 m).</li></ul>
						<img width="auto" height="220px" data-src="img/StreamBurning/Table1.png" alt="Table 1">
						<ul>
							<li>Used the Ontario Hydro Network (OHN) watercourse data set.
								<ul><li>Original source data derived from 1:10 000 scale photogrammetrically
									mapped Ontario Base Map (OBM) data (Ontario Ministry of Natural Resources, 1994).</li></ul>
								</li>
						</ul>
          </section>

					<section class=transparentTextBox>
						<h3>Stream pruning results</h3>
						<ul><li>Resulting stream pruning after applying <em>TopologicalBreachBurn</em> to the
							test DEMs</li></ul>
						<img width="auto" height="220px" data-src="img/StreamBurning/Table2.png" alt="Table 2">
          </section>

					<section class=transparentTextBox>
						<h3>Comparison of watershed boundaries</h3>
            <img class="withBorderAndShadow" width="900px" height="392px" data-src="img/StreamBurning/Fig5Horizontal.png" alt="Fig 5">
          </section>

					<section class=transparentTextBox>
						<h3>Comparison of watershed boundaries</h3>
						<ul><li>Results of applying <em>TopologicalBreachBurn</em> (TBB) to the test DEMs,
							compared with the <em>FillBurn</em> (FB) method.</li></ul>
						<img width="auto" height="220px" data-src="img/StreamBurning/Table3.png" alt="Table 2">
          </section>

					<section class=transparentTextBox>
						<h3>Comparison of modeled surface flow-paths</h3>
            <img class="withBorderAndShadow" width="auto" height="600" data-src="img/StreamBurning/Fig6.png" alt="Fig 6">
          </section>

					<section class=transparentTextBox>
						<h3>LiDAR and stream burning</h3>
            <img class="withBorderAndShadow" width="790px" height="600px" data-src="img/StreamBurning/LiDAR.png" alt="Lidar">
          </section>

					<section class=transparentTextBox>
						<h3>Conclusions</h3>
						<ul>
							<li>The <em>TopologicalBreachBurn</em> tool prunes a vector hydrography layer
								to a level of detail that matches the raster DEM.</li>
							</br><li>Prunning reduces the occurrence of erroneous stream piracy caused by the rasterization
								of multiple competing stream links to the same DEM grid cell.</li>
							</br><li>The algorithm restricts in-channel flow to individual reaches, thereby reducing
								stream piracy in areas of spurious stream adjacency.</li>
						</ul>
					</section>

					<section class=transparentTextBox>
						<h3>Conclusions</h3>
						<ul>
							<li>Application to a large region within southwestern Ontario and five test DEMs with
								widely varying grid resolutions demonstrated that, compared with traditional stream
								burning methods, the <em>TopologicalBreachBurn</em> method can produce very accurate drainage
								patterns and watershed boundaries even at coarser resolutions.</li>
							</br><li>Practitioners must consider the assumptions the technique and
							should not apply it in situations where the
							DEM is of higher accuracy than the mapped hydrography.</li>
						</ul>
					</section>

					<section class=transparentTextBox>
						<h3>Thank you!</h3>
						<ul><li>I would be happy to answer any questions.</li></ul>
						</br></br></br></br><div><div><small>Research support has been provided by: </small></div><img width="auto" height="80px" data-src="img/NSERC_logo.png" alt="NSERC"></div>
					</section>

        </section>

      </div> <!-- slides -->
		</div> <!-- reveal -->

		<script src="./revealjs/lib/js/head.min.js"></script>
		<script src="./revealjs/js/reveal.js"></script>

		<script>

			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,
				slideNumber: 'c / t',
        transition: 'convex', // default/none/fade/slide/convex/concave/zoom
        mouseWheel: true,
        overview: true,

        parallaxBackgroundImage: "img/texture1.png",

        // Parallax background size
        parallaxBackgroundSize: '"1100px 1000px"', // CSS syntax, e.g. "2100px 900px"
        parallaxBackgroundHorizontal: 40,
        parallaxBackgroundVertical: 40,

        // Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: './revealjs/lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: './revealjs/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: './revealjs/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: './revealjs/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: './revealjs/plugin/notes/notes.js' }
				]
			});

		</script>

    <!-- Template Slide
    <section>
      <h3>Title</h3>
      <ul>
        <li>Item1</li>
        <li>Item2</li>
        <li>Item3</li>
        <li>Item4</li>
      </ul>
    </section>
    -->
		<!-- Template image
		<img width="px" height="px" data-src="img/image.png" alt="Title">
		-->


		<!-- <section>
			<section class=transparentTextBox>
				<h3>Sink removal</h3>
				<ul>
					<li>If a DEM hasn't been processed using <highlightedText>flow-path enforcement</highlightedText> techniques, it will contain
					<highlightedText>sinks</highlightedText>
						<ul>
							<li>sinks = topographic depressions and flats</li>
						</ul>
					</li>
					<br/><li>Sinks are caused by a range of errors and natural causes</li>
					<br/><li><highlightedText>Sinks must be removed</highlightedText> in hydrological applications</li>
				</ul>
				<br/><img width="582px" height="230px" data-src="img/Breaching/SinkRemovalMethods.png" alt="Sink removal">
			</section>

			<section class=transparentTextBox>
				<h3>The impact of sink removal</h3>
				<ul>
					<li>In modifying a DEM to enforce flow through sinks, it is desirable to make
						<highlightedText>minimal alterations to the source data</highlightedText>.</li>
					<br/><li>Academics have been telling practitioners for years that <highlightedText><em>depression filling impacts
					DEMs far more than breaching and hybrid methods</em></highlightedText>
						<ul>
							<li>Rieger 1998; Martz &amp; Garbrecht 1999; Soille 2004; Lindsay &amp; Creed 2005;
								Lindsay &amp; Dhun 2015.</li>
						</ul>
					</li>
				</ul>
			</section>

			<section class=transparentTextBox>
				<img width="879px" height="650px" data-src="img/Breaching/FillingImpact.png" alt="Sink removal">
			</section>

			<section class=transparentTextBox>
				<h3>Why do practitioners fill depressions?</h3>
				<ul>
					<li>Depression filling algorithms were <highlightedText>developed first</highlightedText>.</li>
					<br/><li>Filling tools are <highlightedText>available</highlightedText> in nearly every GIS.</li>
					<br/><li>All filling algorithms result in the same solution. The focus of developing new algorithms
					has been creating <highlightedText>more efficient</highlightedText> filling methods
						<ul><li>Jenson &amp; Domingue 1988;
							Planchon &amp; Darboux 2002; Wang &amp; Liu 2006; Wallis et al. 2009; Barnes et al. 2014;
							Yu et al. 2014</li></ul>
					</li>
				</ul>
			</section>

			<section class=transparentTextBox>
				<h3>Can a breaching method be devised to encourage adoption by practitioners?</h3>
				<ul>
					<li>Breaching methods are less efficient and are largely unavailable
						as tools in common GIS software.</li>
					<br/><li>An ideal breaching method would have <highlightedText>similar efficiency to modern
						filling methods</highlightedText>.
						<ul><li>Flow enforcement is the first step in the workflow and practitioners don't want to have
						to spend hours or days processing.</li></ul>
					</li>

				</ul>
			</section>

			<section class=transparentTextBox>
				<h3>Can a breaching method be devised to encourage adoption by practitioners?</h3>
				<ul>
					<li>It must be able to <highlightedText>handle massive DEMs</highlightedText>; robustness is very
						important.</li>
					<br/><li>It should handle <highlightedText>special cases</highlightedText> where breaching is the
						wrong choice for handling individual sinks.</li>
					<br/><li>The tool should be implemented in a way that it can be <highlightedText>readily
						integrated into GIS</highlightedText>.</li>
				</ul>
			</section>

			<section class=transparentTextBox>
				<h3>Efficient breaching-based flow enforcement</h3>
				<ul>
					<li>The highly efficient <highlightedText>priority-flood</highlightedText> algorithm was used to visit
						DEM cells in the flood order.</li>
				</ul>
				<img width="400px" height="309px" data-src="img/Breaching/priorityFlood2.gif" alt="Priority flood">
			</section>

			<section class=transparentTextBox>
				<h3>Efficient breaching-based flow enforcement</h3>
				<ul>
					<li>As new cells are flooded, we keep track of the neighbour from which the flood wave propagated.</li>
					<li>When a depression is located, we attempt to create a breach channel to connect it with the edge.</li>
					<li>If the required breach channel is too deep or too long the sink is filled in a subsequent step.</li>
					<li>The new method is best characterized as a breach-first/fill-second
						hybrid flow enforcement algorithm.</li>
				</ul>
			</section>

			<section class=transparentTextBox>
				<img width="535px" height="650px" data-src="img/Breaching/breachingAlgorithm.png" alt="New breaching algorithm">
			</section>

			<section class=transparentTextBox>
				<img width="800px" height="525px" data-src="img/Breaching/GoSpatialBreachDepressions.png" alt="New breaching algorithm">
			</section>

			<section class=transparentTextBox>
				<img width="900px" height="639px" data-src="img/Breaching/Fig3Clr.png" alt="New breaching algorithm">
			</section>

			<section class=transparentTextBox>
				<img width="900px" height="321px" data-src="img/Breaching/BreachingTable1.png" alt="New breaching algorithm">
				<div><small>The two largest DEMs had nearly 1 billion grid cells and were 3.5 GB in size.</small></div>
			</section>

			<section class=transparentTextBox>
				<h3>Evaluation of the new method</h3>
				<ul>
					<li>Each of the test DEMs were processed using the new algorithm in <em>complete breaching</em> (B),
					<em>selective breaching</em> (SB), and <em>constrained breaching</em> (CB) modes.</li>
					<br/><li>Tests were run on a 3.0-GHz 8-core Intel processor computer system with 64 GB
						of 1866-MHz DDR3 memory.</li>
					<br/><li>The performance of the method was compared against the Wang and Liu (2006)
						depression filling algorithm.</li>
					<br/><li>Efforts were made to minimize the implementation differences between the filling and breaching methods.</li>
				</ul>
			</section>

			<section class=transparentTextBox>
				<img width="800px" height="472px" data-src="img/Breaching/BreachingTable2.png" alt="New breaching algorithm">
			</section>

			<section class=transparentTextBox>
				<img width="841px" height="650px" data-src="img/Breaching/SouthCentralQuebec.png" alt="Impact map 1">
			</section>

			<section class=transparentTextBox>
				<img width="841px" height="650px" data-src="img/Breaching/FillingImpact2.png" alt="Impact map 2">
			</section>

			<section class=transparentTextBox>
				<img width="841px" height="650px" data-src="img/Breaching/BreachingImpact.png" alt="Impact map 3">
			</section>

			<section class=transparentTextBox>
				<img width="841px" height="650px" data-src="img/Breaching/SelectiveBreachingImpact.png" alt="Impact map 4">
			</section>

			<section class=transparentTextBox>
				<img width="841px" height="650px" data-src="img/Breaching/ConstrainedBreachingImpact.png" alt="Impact map 5">
			</section>

			<section class=transparentTextBox>
				<h3>Conclusions</h3>
				<ul>
					<li>While breaching based and hybrid sink removal methods have been demonstrated to reduce
						impacts compared with depression filling, performance and robustness issues and the lack
						of availability have <highlightedText>limited their use</highlightedText>.</li>
					<br/><li>This work has demonstrated that
						 shortcomings of existing breaching/hybrid methods is <highlightedText>not inherent in the approach</highlightedText> to sink
						removal and that the issues affecting the widespread application of the approach in
						common practice can be resolved.</li>
				</ul>
			</section>

			<section class=transparentTextBox>
				<h3>Conclusions</h3>
				<ul>
					<li>Operating in B and SB modes, the new algorithm was found to <highlightedText>offer similar performance</highlightedText>
						to the Wang and Liu (2006) filling algorithm. In SB mode, the new algorithm was a
						pproximately 8% slower.</li>
					<br/><li>The CB mode was found to be most strongly affected by the use of a maximum breach
						channel length parameter.</li>
						<br/><li>The new algorithm was <highlightedText>capable of processing massive DEMs</highlightedText> of widely varying
							spatial resolution and extent.</li>
				</ul>
			</section>

			<section class=transparentTextBox>
				<h3>Acknowledgements</h3>
				<ul>
					<li>This work was partially funded through a grant provided by the Natural Sciences and Engineering Research Council of Canada.</li>
					<br/><li>Questions?</li>
				</ul>
			</section>
		</section> -->


	</body>
</html>
